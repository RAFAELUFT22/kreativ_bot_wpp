UPDATE workflow_entity SET nodes = '[{"parameters": {"httpMethod": "POST", "path": "kreativ-unified-api", "responseMode": "responseNode", "options": {}, "webhookId": "kreativ-unified-api-id"}, "name": "Webhook API", "type": "n8n-nodes-base.webhook", "typeVersion": 2, "id": "c5a47c17-2976-4a8b-89ee-7917a7a835b1"}, {"parameters": {"jsCode": "const body = .body || ;\nconst phone = String(body.phone || \"\").replace(/\\D/g, \"\");\nconst action = body.action || \"check_student\";\nreturn [{ json: { ...body, phone, action } }];"}, "name": "Normalizar Input", "type": "n8n-nodes-base.code", "typeVersion": 2, "id": "3a09cc64-504f-4fc4-9bbe-a8f28e6fa83a"}, {"parameters": {"rules": {"values": [{"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "check_student", "operator": {"type": "string", "operation": "equals"}}]}}, {"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "request_human", "operator": {"type": "string", "operation": "equals"}}]}}, {"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "get_module", "operator": {"type": "string", "operation": "equals"}}]}}, {"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "get_progress", "operator": {"type": "string", "operation": "equals"}}]}}, {"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "submit_quiz", "operator": {"type": "string", "operation": "equals"}}]}}, {"conditions": {"conditions": [{"leftValue": "={{ .action }}", "rightValue": "ai_tutor", "operator": {"type": "string", "operation": "equals"}}]}}]}}, "name": "Roteador de A\u00e7\u00f5es", "type": "n8n-nodes-base.switch", "typeVersion": 3, "id": "29d3f608-bb9a-47af-ac6f-5284aec3aacb"}, {"parameters": {"method": "POST", "url": "https://n8n.extensionista.site/webhook/kreativ-ai-tutor-v3", "sendBody": true, "specifyBody": "json", "jsonBody": "={{ { phone: .phone, body: .message || .body || \"Oi\" } }}", "options": {}}, "name": "AI Tutor: Proxy Request", "type": "n8n-nodes-base.httpRequest", "typeVersion": 4.2, "id": "0236a2de-5b5a-4ce4-aa11-5640ebf57364"}, {"parameters": {"respondWith": "json", "responseBody": "={{ JSON.stringify() }}"}, "name": "Responder Typebot", "type": "n8n-nodes-base.respondToWebhook", "typeVersion": 1, "id": "47e7ee75-9915-44f5-b0d6-95dbba669854"}]', connections = '{"Webhook API": {"main": [[{"node": "Normalizar Input", "type": "main", "index": 0}]]}, "Normalizar Input": {"main": [[{"node": "Roteador de A\u00e7\u00f5es", "type": "main", "index": 0}]]}, "Roteador de A\u00e7\u00f5es": {"main": [[], [], [], [], [], [{"node": "AI Tutor: Proxy Request", "type": "main", "index": 0}]]}, "AI Tutor: Proxy Request": {"main": [[{"node": "Responder Typebot", "type": "main", "index": 0}]]}}' WHERE id = 'krpsi0uW7fMhxj5T';
